import mediapipe as mp # 住驻专 专 砖转  爪专  驻 
import numpy as np # 注 注 注专 拽专 转 
import cv2 # 住驻专转 拽 驻转  驻 注 转
import pandas as pd # 注 注 拽爪 拽专 转 
import os# 驻砖专 爪专 专拽爪 注 住驻专 驻拽爪转 砖 注专转 驻注
from sklearn.model_selection import train_test_split #   专转 + 砖砖 转  砖 转 
from keras.utils import to_categorical # 砖砖  注拽 转 砖转 
from scipy import stats #  住驻专转 拽 驻转 砖砖转 驻转专 注转 转转, 注转, 住转 转
from matplotlib import pyplot as plt #  住驻专 拽驻 爪专转 转 住转
from bidi.algorithm import get_display


 # 拽转 驻转 爪注转 MP Holistic  

# 住      Mediapipe Holistic   爪专转  专 驻,  转 
mp_holistic = mp.solutions.holistic
# 注专 爪专
mp_drawing = mp.solutions.drawing_utils




def mediapipe_detection(img, mp_holistic):
    img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB) # 专转 爪注 BGR 2 RGB
    img.flags.writeable = False# 转 专  转转 转
    res = mp_holistic.process(img)# 爪注 转转
    img.flags.writeable = True  # 转 转转 转
    img = cv2.cvtColor(img, cv2.COLOR_RGB2BGR)# 住 爪注 RGB 2 BGR
    return img, res
    
    
    # 爪专 转转 
    
    def holistic_drawing(img, holistic_res):
    # 爪专 专 驻
    # mp_drawing.draw_landmarks(img, holistic_res.face_landmarks, mp_holistic.FACEMESH_TESSELATION, 
    #                          mp_drawing.DrawingSpec(color=(80,110,10), thickness=1, circle_radius=1), 
    #                          mp_drawing.DrawingSpec(color=(80,256,120), thickness=1, circle_radius=1)
    #                          ) 
    # 爪专 专 转
    mp_drawing.draw_landmarks(img, holistic_res.pose_landmarks, mp_holistic.POSE_CONNECTIONS,
                             mp_drawing.DrawingSpec(color=(200,50,50), thickness=2, circle_radius=4), 
                             mp_drawing.DrawingSpec(color=(200,25,25), thickness=2, circle_radius=2)
                             ) 
       # 爪专 专  砖
    mp_drawing.draw_landmarks(img, holistic_res.left_hand_landmarks, mp_holistic.HAND_CONNECTIONS, 
                             mp_drawing.DrawingSpec(color=(25,25,200), thickness=2, circle_radius=4), 
                             mp_drawing.DrawingSpec(color=(50,50,200), thickness=2, circle_radius=2)
                             ) 
     # 爪专 专  
    mp_drawing.draw_landmarks(img, holistic_res.right_hand_landmarks, mp_holistic.HAND_CONNECTIONS, 
                             mp_drawing.DrawingSpec(color=(25,25,200), thickness=2, circle_radius=4), 
                             mp_drawing.DrawingSpec(color=(50,50,200), thickness=2, circle_radius=2)
                             )
# 拽 驻转转 爪

cap = cv2.VideoCapture(0)
with mp_holistic.Holistic(min_detection_confidence = 0.5, min_tracking_confidence = 0.5) as holistic_model:
    while cap.isOpened():
        _, frame = cap.read()
        img, results = mediapipe_detection(frame, holistic_model)
        holistic_drawing(img, results)
        cv2.imshow("OpenCV Cam feed", img)
        if cv2.waitKey(10) & 0xFF == ord('q'):
            break
cap.release()
cv2.destroyAllWindows()
cv2.waitKey(1)
                             
                             
                             
    






